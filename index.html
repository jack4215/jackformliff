<!doctype html>
<html class="no-js" lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta name="robots" content="noindex, nofollow">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:title" content="">
  <meta property="og:description" content="">
  <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
  <script>
    window.onload = function () {
      var path = new URL(window.location);
      var liffId = path.searchParams.get('liff_id');
      var formUrl = path.searchParams.get('form');
      var redirect = function(name) {
        var src = decodeURIComponent(formUrl.replace('*%7CNAME%7C*', name));
        try {
          window.location.replace(src);
        } catch {
          window.location.href = src;
        }
      };

      if (!path.searchParams.has('liff_id') || !path.searchParams.has('form')) {
        alert('請使用 LINE 應用程式開啟，若您已使用 LINE 應用程式開啟，還請再確認網址是否無誤，感謝您的配合');
        return;
      }

      liff.init({
        liffId: liffId
      }).then(function (e) {
        var isLoggedIn = liff.isLoggedIn();
        var context = liff.getContext();

        if (isLoggedIn) {
          liff.getProfile()
            .then(function(data) {
              redirect(data.displayName);
            })
            .catch(function(err) {
              alert(err);
            })
        } else {
          liff.login({
            redirectUri: location.href
          })
        }
      }).catch(function (e) {
        alert(e);
      })
    }
  </script>
</head>

<body>
  <p><img src="https://i.imgur.com/gINQwDy.jpg" width="400"></p>
</body>

</html>
